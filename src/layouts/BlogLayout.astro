---
// Blog Layout
// ------------
// Description: A layout for blog posts
// Properties:
// - frontmatter: The frontmatter of the blog post

// Imports
const { frontmatter } = Astro.props

// Components
// - Layout
import Layout from './Layout.astro'
import Col from '../components/ui/Col.astro'
import Row from '../components/ui/Row.astro'
import Section from '../components/ui/Section.astro'
// - UI
import Card from '../components/ui/cards/Card.astro'

// Content
// - Locale
const currentLocale = Astro.currentLocale || 'en'
// - Formatting author slug like "john-doe" into "John Doe"
export const formattedAuthorName = (author: string) =>
	author
		.split('-')
		.map((part) => part.charAt(0).toUpperCase() + part.slice(1))
		.join(' ')
---

<Layout title={frontmatter.title} description={frontmatter.description}>
	<Section classes="pb-0! overflow-visible!">
		<Row>
			<Col span="12">
				<h1>{frontmatter.title}</h1>
			</Col>
		</Row>
	</Section>
	<Section stickyCol classes="overflow-visible!">
		<Row classes="mb-15">
			{
				frontmatter.image && (
					<Col span="12">
						<Card
							image={frontmatter.image}
							cardMediaClasses="lg:h-[800px] h-full object-cover w-full"
							classes="w-full"
							mediaEffect="parallax"
						/>
					</Col>
				)
			}
			{
				frontmatter.video && (
					<Col span="12">
						<Card
							video={frontmatter.video}
							cardMediaClasses="lg:h-[800px] w-full h-full object-cover"
							classes="w-full"
						/>
					</Col>
				)
			}
		</Row>
		<Row>
			<Col span="3" classes="no-scroll-animation">
				<div class="sticky top-32">
					<Card
						title={formattedAuthorName(frontmatter.author)}
						subtitle={new Date(frontmatter.pubDate).toLocaleDateString(
							currentLocale === 'fr' ? 'fr-ES' : 'en-US',
							{
								year: 'numeric',
								month: 'long',
								day: 'numeric'
							}
						)}
						titleLink={`/blog/author/${frontmatter.author}`}
					/>
				</div>
			</Col>
			<Col span="9" classes="basic-text text-lead no-scroll-animation">
				<slot />
			</Col>
		</Row>
	</Section>
</Layout>
